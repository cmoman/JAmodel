

Demonstration of identification of Jiles-Atherton models parameters for three hysteresis loops.
Multistep solver.
Demonstration optimized for OCTAVE.  
Demonstration requires odepkg, struct and optim packages installed.


 odepkg installed...ok.
 WARNING: odepkg is installed but not loaded.
 Problem solved: odepkg is loaded now.


 struct installed...ok.
 WARNING: struct is installed but not loaded.
 Problem solved: struct is loaded now.


 optim installed...ok.
 WARNING: optim is installed but not loaded.
 Problem solved: optim is loaded now.

Load measured B(H) characterisitcs of Mn-Zn ferrite... done

Initial analyse of input data... 

Number of loops: 3 
Maximal magnetizing field H(A/m): 106.29, pos. at col:1 , pos. at row:3 
Maximal magnetization M(A/m): 274427 
Maximal flux density B(T): 0.345 
Number of x axis crossings at major loop: 2 
Estimated value of Hc (A/m): 11.68 

Done. 

                                                                                                                    Input data
  B (T)
    0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
        +                                     +                                    +                                     +                                     +                                    +                                     +
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                           --+-+--+-+--+-+                                |
        |                                     :                                    :                                     :                                     :               -+--+-+--+-+--+-+-   :                                     |
        |                                     :                                    :                                     :                                     :     -+-+--+--+-+--+-+-             :                                     |
    0.3 ++...................................................................................................................................................-+--+--+.....-+--+..........................................................++
        |                                     :                                    :                                     :                           --+-+--+  :     -+--+                          :                                     |
        |                                     :                                    :                                     :                       -+-+          :   -+                               :                                     |
        |                                     :                                    :                                     :                    --+             -+-+-                                 :                                     |
        |                                     :                                    :                                     :               -+--+             -+- :                                    :                                     |
        |                                     :                                    :                                     :            --+               -+-    :                                    :                                     |
        |                                     :                                    :                                     :          -+                -+       :                                    :                                     |
    0.2 ++.......................................................................................................................--+................++...................................................................................++
        |                                     :                                    :                                     :      +              +++++-          :                                    :                                     |
        |                                     :                                    :                                     :     +           ++++ +++            :                                    :                                     |
        |                                     :                                    :                                     :  --+        ++++  +++-              :                                    :                                     |
        |                                     :                                    :                                     : +        +++    +++                 :                                    :                                     |
        |                                     :                                    :                                     :+      +++      ++-                  :                                    :                                     |
        |                                     :                                    :                                   --+     +++      +++                    :                                    :                                     |
    0.1 ++...................................................................................................................++.......++.+...............................................................................................++
        |                                     :                                    :                                  +  : ++      ++++ +                      :                                    :                                     |
        |                                     :                                    :                                 +   :++    +++++ --                       :                                    :                                     |
        |                                     :                                    :                              --+   ++    ++++++ +                         :                                    :                                     |
        |                                     :                                    :                                  ++ : +++ +++  +                          :                                    :                                     |
        |                                     :                                    :                             +    +  +++ ++ ++ +                           :                                    :                                     |
      0 ++.......................................................................................................|..++.+++.+++.+..+......................................................................................................++
        |                                     :                                    :                             | + +++ +++ ++  +                             :                                    :                                     |
        |                                     :                                    :                         --+ ++ ++ +++  +   +                              :                                    :                                     |
        |                                     :                                    :                             +++ ++  : +   +                               :                                    :                                     |
        |                                     :                                    :                        +  ++++++    ++   +                                :                                    :                                     |
        |                                     :                                    :                       +  ++++     ++:  --                                 :                                    :                                     |
        |                                     :                                    :                    --+ +++       +  : +                                   :                                    :                                     |
   -0.1 ++.................................................................................................++.......++....+..............................................................................................................++
        |                                     :                                    :                   + ++      +++     +                                     :                                    :                                     |
        |                                     :                                    :                  +++      +++     --:                                     :                                    :                                     |
        |                                     :                                    :               --++     +++      -+  :                                     :                                    :                                     |
        |                                     :                                    :             -++++  ++++        +    :                                     :                                    :                                     |
        |                                     :                                    :          --+++ ++++          --     :                                     :                                    :                                     |
        |                                     :                                    :           +++++            -+       :                                     :                                    :                                     |
   -0.2 ++..................................................................................-++...............-+.........................................................................................................................++
        |                                     :                                    :     --+               -+-           :                                     :                                    :                                     |
        |                                     :                                    :   -+                -+              :                                     :                                    :                                     |
        |                                     :                                    :--+             -+-+-                :                                     :                                    :                                     |
        |                                     :                                --+-+             -+-                     :                                     :                                    :                                     |
        |                                     :                              -+    :        -+--+                        :                                     :                                    :                                     |
        |                                     :                         -+--+      :   -+--+                             :                                     :                                    :                                     |
   -0.3 ++......................................................--+-+--+........-+-+--+..................................................................................................................................................++
        |                                     :            --+-+      -+-+--+-+-   :                                     :                                     :                                    :                                     |
        |                                     :  --+-+--+-+--+-+--+-+-             :                                     :                                     :                                    :                                     |
        |                                +-+--+-+--+-+-                            :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        +                                     +                                    +                                     +                                     +                                    +                                     +
   -0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
      -150                                  -100                                  -50                                    0                                    50                                   100                                   150
                                                                                                                      H (A/m)

Identification of parameters for anhysteretic loop...

                                                                                                         Anhysteretic curve starting point
  B (T)
    0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
        +                                     +                                    +                                     +                                     +                                    +                                     +
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                           --+-+--+-+--+-+                                |
        |                                     :                                    :                                     :                                     :               -+--+-+--+-+--+-+-   :                                     |
        |                                     :                                    :                                     :                                     :     -+-+--+--+-+--+-+-             :--+-+                                |
    0.3 ++...................................................................................................................................................-+--+--+.....-+--+..--+-+--+-+--+-+--+-+-...................................++
        |                                     :                                    :                                     :                           --+-+--+  :     -+--+-+--+-+-                  :                                     |
        |                                     :                                    :                                     :                       -+-+        -+--+--+                               :                                     |
        |                                     :                                    :                                     :                    --+       -+--+--+-+-                                 :                                     |
        |                                     :                                    :                                     :               -+--+     -+--+   -+- :                                    :                                     |
        |                                     :                                    :                                     :            --+        -+-    -+-    :                                    :                                     |
        |                                     :                                    :                                     :          -+        --+     -+       :                                    :                                     |
    0.2 ++.......................................................................................................................--+.......--+.......+...................................................................................++
        |                                     :                                    :                                     :      +        -+-       --          :                                    :                                     |
        |                                     :                                    :                                     :     +      --+        -+            :                                    :                                     |
        |                                     :                                    :                                     :  --+       --      -+-              :                                    :                                     |
        |                                     :                                    :                                     : +        -+       +                 :                                    :                                     |
        |                                     :                                    :                                     :+      --+       --                  :                                    :                                     |
        |                                     :                                    :                                   --+       --       +                    :                                    :                                     |
    0.1 ++......................................................................................................................+........+...............................................................................................++
        |                                     :                                    :                                  +  :     +        +                      :                                    :                                     |
        |                                     :                                    :                                 +   :  --+       --                       :                                    :                                     |
        |                                     :                                    :                              --+    :  --       +                         :                                    :                                     |
        |                                     :                                    :                                     : +        +                          :                                    :                                     |
        |                                     :                                    :                             +       :||       +                           :                                    :                                     |
      0 ++.......................................................................................................|........||......+......................................................................................................++
        |                                     :                                    :                             |     --+       +                             :                                    :                                     |
        |                                     :                                    :                         --+       --:      +                              :                                    :                                     |
        |                                     :                                    :                                  +  :     +                               :                                    :                                     |
        |                                     :                                    :                        +        +   :    +                                :                                    :                                     |
        |                                     :                                    :                       +      --+    :  --                                 :                                    :                                     |
        |                                     :                                    :                    --+       --     : +                                   :                                    :                                     |
   -0.1 ++.......................................................................................................+........+..............................................................................................................++
        |                                     :                                    :                   +        +        +                                     :                                    :                                     |
        |                                     :                                    :                  +      --+       --:                                     :                                    :                                     |
        |                                     :                                    :               --+       --      -+  :                                     :                                    :                                     |
        |                                     :                                    :             -+        -+       +    :                                     :                                    :                                     |
        |                                     :                                    :          --+       --+       --     :                                     :                                    :                                     |
        |                                     :                                    :                  -+-       -+       :                                     :                                    :                                     |
   -0.2 ++..................................................................................-+.....--+........-+.........................................................................................................................++
        |                                     :                                    :     --+     -+-       -+-           :                                     :                                    :                                     |
        |                                     :                                    :   -+     --+        -+              :                                     :                                    :                                     |
        |                                     :                                    :--+  --+-+-     -+-+-                :                                     :                                    :                                     |
        |                                     :                                --+-+--+-+-       -+-                     :                                     :                                    :                                     |
        |                                     :                              -+--+-+-       -+--+                        :                                     :                                    :                                     |
        |                                     :                 --+-+--+-+--+      :   -+--+                             :                                     :                                    :                                     |
   -0.3 ++..................................--+-+--+-+--+-+--+-+--+-+--+........-+-+--+..................................................................................................................................................++
        |                                +-+- :            --+-+      -+-+--+-+-   :                                     :                                     :                                    :                                     |
        |                                     :  --+-+--+-+--+-+--+-+-             :                                     :                                     :                                    :                                     |
        |                                +-+--+-+--+-+-                            :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        +                                     +                                    +                                     +                                     +                                    +                                     +
   -0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
      -150                                  -100                                  -50                                    0                                    50                                   100                                   150
                                                                                                                      H (A/m)

Initial target value for a=11.684 (A/m), Ms=274427 (A/m), alpha=1.000000e-06 Target=0.366 

Optimization process started... 

Iteration: 1,  Best: 3.2367e-01,  Worst: 1.7559e+01
x(1) = 5.842063e+01
x(2) = 4.307950e+05
x(3) = 2.399648e-04
Iteration: 2,  Best: 3.1526e-01,  Worst: 5.4676e+00
x(1) = 5.842063e+01
x(2) = 4.223454e+05
x(3) = 2.681314e-04
Iteration: 3,  Best: 3.0950e-01,  Worst: 3.9471e+00
x(1) = 5.255931e+01
x(2) = 3.939732e+05
x(3) = 2.605634e-04
Iteration: 4,  Best: 3.0950e-01,  Worst: 1.3610e+00
x(1) = 5.255931e+01
x(2) = 3.939732e+05
x(3) = 2.605634e-04
Iteration: 5,  Best: 3.0950e-01,  Worst: 5.5790e-01
x(1) = 5.255931e+01
x(2) = 3.939732e+05
x(3) = 2.605634e-04
Iteration: 6,  Best: 3.0950e-01,  Worst: 5.5790e-01
x(1) = 5.255931e+01
x(2) = 3.939732e+05
x(3) = 2.605634e-04
Iteration: 7,  Best: 3.0950e-01,  Worst: 5.5790e-01
x(1) = 5.255931e+01
x(2) = 3.939732e+05
x(3) = 2.605634e-04
warning: division by zero
warning: called from
    fzero at line 237 column 14
    Mah_loop at line 115 column 21
    Mah_loop_target at line 113 column 8
    DemoPeng_et_al> at line -1 column -1
    de_min at line 365 column 13
    DemoPeng_et_al at line 169 column 41
Iteration: 8,  Best: 3.0942e-01,  Worst: 3.8820e-01
x(1) = 5.250945e+01
x(2) = 3.921328e+05
x(3) = 2.673494e-04
Iteration: 9,  Best: 3.0866e-01,  Worst: 3.5309e-01
x(1) = 3.665630e+01
x(2) = 3.730979e+05
x(3) = 1.478065e-04
Iteration: 10,  Best: 3.0826e-01,  Worst: 3.2868e-01
x(1) = 3.844241e+01
x(2) = 3.708371e+05
x(3) = 1.687010e-04
Iteration: 11,  Best: 3.0794e-01,  Worst: 3.2868e-01
x(1) = 3.106268e+01
x(2) = 3.604532e+05
x(3) = 1.108617e-04
Iteration: 12,  Best: 3.0785e-01,  Worst: 3.2643e-01
x(1) = 2.947510e+01
x(2) = 3.544304e+05
x(3) = 1.065550e-04
Iteration: 13,  Best: 3.0785e-01,  Worst: 3.1557e-01
x(1) = 2.947510e+01
x(2) = 3.544304e+05
x(3) = 1.065550e-04
Iteration: 14,  Best: 3.0785e-01,  Worst: 3.1557e-01
x(1) = 2.947510e+01
x(2) = 3.544304e+05
x(3) = 1.065550e-04
Iteration: 15,  Best: 3.0757e-01,  Worst: 3.1302e-01
x(1) = 2.795652e+01
x(2) = 3.525107e+05
x(3) = 9.076288e-05
Iteration: 16,  Best: 3.0739e-01,  Worst: 3.1207e-01
x(1) = 2.321194e+01
x(2) = 3.422687e+05
x(3) = 5.166682e-05
Iteration: 17,  Best: 3.0729e-01,  Worst: 3.1207e-01
x(1) = 2.433813e+01
x(2) = 3.428830e+05
x(3) = 6.493912e-05
Iteration: 18,  Best: 3.0729e-01,  Worst: 3.1187e-01
x(1) = 2.433813e+01
x(2) = 3.428830e+05
x(3) = 6.493912e-05
Iteration: 19,  Best: 3.0729e-01,  Worst: 3.1030e-01
x(1) = 2.433813e+01
x(2) = 3.428830e+05
x(3) = 6.493912e-05
Iteration: 20,  Best: 3.0724e-01,  Worst: 3.1030e-01
x(1) = 2.129893e+01
x(2) = 3.366444e+05
x(3) = 4.008260e-05
Iteration: 21,  Best: 3.0724e-01,  Worst: 3.1030e-01
x(1) = 2.274597e+01
x(2) = 3.396864e+05
x(3) = 5.058595e-05
Iteration: 22,  Best: 3.0719e-01,  Worst: 3.1030e-01
x(1) = 2.071736e+01
x(2) = 3.342947e+05
x(3) = 3.620891e-05
Iteration: 23,  Best: 3.0717e-01,  Worst: 3.1012e-01
x(1) = 2.031258e+01
x(2) = 3.331073e+05
x(3) = 3.215240e-05
Iteration: 24,  Best: 3.0717e-01,  Worst: 3.0786e-01
x(1) = 2.031258e+01
x(2) = 3.331073e+05
x(3) = 3.215240e-05
Elapsed time is 1272.69 seconds.


Optimiation process done.

Final target value for a=20.313 (A/m), Ms=333107 (A/m), alpha=3.215240e-05 Target=0.307 

                                                                                                           Anhysteretic curve optimised
  B (T)
    0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
        +                                     +                                    +                                     +                                     +                                    +                                     +
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                           --+-+--+-+--+-+                                |
        |                                     :                                    :                                     :                                     :               -+--+-+--+-+--+-+-   :                                     |
        |                                     :                                    :                                     :                                     :     -+-+--+--+-+--+-+-             :                                     |
    0.3 ++...................................................................................................................................................-+--+--+-+-+--+--+..........................................................++
        |                                     :                                    :                                     :                           --+-+--+  --+--+-+--+                          :                                     |
        |                                     :                                    :                                     :                       -+-+     --+-++   -+                               :                                     |
        |                                     :                                    :                                     :                    --+       -+-   -+-+-                                 :                                     |
        |                                     :                                    :                                     :               -+--+       --+   -+- :                                    :                                     |
        |                                     :                                    :                                     :            --+          -++  -+-    :                                    :                                     |
        |                                     :                                    :                                     :          -+           -+-  -+       :                                    :                                     |
    0.2 ++.......................................................................................................................--+..........--+....+...................................................................................++
        |                                     :                                    :                                     :      +          --+     --          :                                    :                                     |
        |                                     :                                    :                                     :     +         -+-     -+            :                                    :                                     |
        |                                     :                                    :                                     :  --+       --+     -+-              :                                    :                                     |
        |                                     :                                    :                                     : +          --     +                 :                                    :                                     |
        |                                     :                                    :                                     :+         -+     --                  :                                    :                                     |
        |                                     :                                    :                                   --+       --+      +                    :                                    :                                     |
    0.1 ++.......................................................................................................................--......+...............................................................................................++
        |                                     :                                    :                                  +  :      +       +                      :                                    :                                     |
        |                                     :                                    :                                 +   :     +      --                       :                                    :                                     |
        |                                     :                                    :                              --+    :  --+      +                         :                                    :                                     |
        |                                     :                                    :                                     :  --      +                          :                                    :                                     |
        |                                     :                                    :                             +       : +       +                           :                                    :                                     |
      0 ++.......................................................................................................|........+.......+......................................................................................................++
        |                                     :                                    :                             |     --+       +                             :                                    :                                     |
        |                                     :                                    :                         --+      +- :      +                              :                                    :                                     |
        |                                     :                                    :                                 +   :     +                               :                                    :                                     |
        |                                     :                                    :                        +     --+    :    +                                :                                    :                                     |
        |                                     :                                    :                       +      --     :  --                                 :                                    :                                     |
        |                                     :                                    :                    --+      +       : +                                   :                                    :                                     |
   -0.1 ++......................................................................................................+.........+..............................................................................................................++
        |                                     :                                    :                   +     --+         +                                     :                                    :                                     |
        |                                     :                                    :                  +     +-         --:                                     :                                    :                                     |
        |                                     :                                    :               --+     +         -+  :                                     :                                    :                                     |
        |                                     :                                    :             -+     --+         +    :                                     :                                    :                                     |
        |                                     :                                    :          --+     -+-         --     :                                     :                                    :                                     |
        |                                     :                                    :               --+          -+       :                                     :                                    :                                     |
   -0.2 ++..................................................................................-+.....--.........-+.........................................................................................................................++
        |                                     :                                    :     --+     -+        -+-           :                                     :                                    :                                     |
        |                                     :                                    :   -+   -+--+        -+              :                                     :                                    :                                     |
        |                                     :                                    :--+  --+        -+-+-                :                                     :                                    :                                     |
        |                                     :                                --+-+   -+-       -+-                     :                                     :                                    :                                     |
        |                                     :                              -+   -+--+     -+--+                        :                                     :                                    :                                     |
        |                                     :                         -+--+-+--+ :   -+--+                             :                                     :                                    :                                     |
   -0.3 ++......................................................--+-+--+-+--+...-+-+--+..................................................................................................................................................++
        |                                     :            --+-+--+-+--+-+--+-+-   :                                     :                                     :                                    :                                     |
        |                                     :  --+-+--+-+--+-+--+-+-             :                                     :                                     :                                    :                                     |
        |                                +-+--+-+--+-+-                            :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        +                                     +                                    +                                     +                                     +                                    +                                     +
   -0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
      -150                                  -100                                  -50                                    0                                    50                                   100                                   150
                                                                                                                      H (A/m)

Adding the hysteresis: JA model... 

Initial point... 
                                                                                                             Hysteretic curve initial
  B (T)
    0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
        +                                     +                                    +                                     +                                     +                                    +                                     +
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                           --+-+--+-+--+-+                                |
        |                                     :                                    :                                     :                                     :               -+--+-+--+-+--+-+--+-+--+-+                                |
        |                                     :                                    :                                     :                                     :     -+-+--+--+-+--+-+-  -+--+-+-   :                                     |
    0.3 ++...................................................................................................................................................-+--+--+-+...-+--+...-+-+--+................................................++
        |                                     :                                    :                                     :                           --+-+--+-+:     -+--+   -+-+-                  :                                     |
        |                                     :                                    :                                     :                       -+-+--+-+     :   -+   -+-+-                       :                                     |
        |                                     :                                    :                                     :                    --+-+-+         -+-+-  -+-                            :                                     |
        |                                     :                                    :                                     :               -+--+--+          -+- :   -+                               :                                     |
        |                                     :                                    :                                     :            --+  --+          -+-   -+-+-                                 :                                     |
        |                                     :                                    :                                     :          -+   -+           -+   -+- :                                    :                                     |
    0.2 ++.......................................................................................................................--+..--+...........++..-+-..............................................................................++
        |                                     :                                    :                                     :      +   -+         +++++- -+       :                                    :                                     |
        |                                     :                                    :                                     :     + --+       ++++ ++++++         :                                    :                                     |
        |                                     :                                    :                                     :  --+ +      ++++ ++++-+++-          :                                    :                                     |
        |                                     :                                    :                                     : +   +    ++++++++++  +++            :                                    :                                     |
        |                                     :                                    :                                     :+ --+  ++++++   ++- ++-              :                                    :                                     |
        |                                     :                                    :                                   --+ +   ++++     +++ ++                 :                                    :                                     |
    0.1 ++................................................................................................................+..++++.....++.+.+-............................................................................................++
        |                                     :                                    :                                  +--+ +++     ++++ +++                    :                                    :                                     |
        |                                     :                                    :                                 ++  :++    +++++ --+                      :                                    :                                     |
        |                                     :                                    :                              --++ +++    +++++++++-                       :                                    :                                     |
        |                                     :                                    :                              --+ ++ : ++++++++ ++                         :                                    :                                     |
        |                                     :                                    :                             +  +++  ++++++++++++                          :                                    :                                     |
      0 ++......................................................................................................-|++++++++.+++++.+++.....................................................................................................++
        |                                     :                                    :                         --+ | +++++ +++ +++++                             :                                    :                                     |
        |                                     :                                    :                         --+++++++++++  +++++                              :                                    :                                     |
        |                                     :                                    :                        +++ +++++++  : ++ ++                               :                                    :                                     |
        |                                     :                                    :                       ++ +++++++    +++--+                                :                                    :                                     |
        |                                     :                                    :                    --++  ++++     ++:-+--                                 :                                    :                                     |
        |                                     :                                    :                   +--+ +++      ++  + +                                   :                                    :                                     |
   -0.1 ++............................................................................................++...++.....++++.--.+..............................................................................................................++
        |                                     :                                    :               --+++ ++    +++++ -+  +                                     :                                    :                                     |
        |                                     :                                    :              +++ +++  +++++++  +  --:                                     :                                    :                                     |
        |                                     :                                    :             ++--++++++ +++   -- -+  :                                     :                                    :                                     |
        |                                     :                                    :          -++-++++  ++++    -+  +    :                                     :                                    :                                     |
        |                                     :                                    :        -+--+++ ++++      -+  --     :                                     :                                    :                                     |
        |                                     :                                    :     --+   +++++       -+-  -+       :                                     :                                    :                                     |
   -0.2 ++.............................................................................-+...-++..........-+...-+.........................................................................................................................++
        |                                     :                                    :--+  --+          -+-  -+-           :                                     :                                    :                                     |
        |                                     :                                   -+   -+           -+   -+              :                                     :                                    :                                     |
        |                                     :                              -+--+ :--+          -+--+-+-                :                                     :                                    :                                     |
        |                                     :                           --+  --+-+        -+--+-+-                     :                                     :                                    :                                     |
        |                                     :                      --+-+   -+    :      -+-+--+                        :                                     :                                    :                                     |
        |                                     :                 --+-+   -+--+     -+--+-+--+                             :                                     :                                    :                                     |
   -0.3 ++...............................................-+--+-+--+-+--+.....-+--+-+--+..................................................................................................................................................++
        |                                     :  --+-+--+  --+-+ -+-+--+-+--+-+-   :                                     :                                     :                                    :                                     |
        |                                +-+--+-+--+-+--+-+--+-+--+-+-             :                                     :                                     :                                    :                                     |
        |                                +-+--+-+--+-+-                            :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        +                                     +                                    +                                     +                                     +                                    +                                     +
   -0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
      -150                                  -100                                  -50                                    0                                    50                                   100                                   150
                                                                                                                      H (A/m)

Optimization process started... 

Iteration: 1,  Best: 6.9077e-02,  Worst: 2.2562e+00
x(1) = 6.802742e+00
x(2) = 9.758831e-01
Iteration: 2,  Best: 6.7682e-02,  Worst: 1.3489e+00
x(1) = 8.314526e+00
x(2) = 9.409569e-01
Iteration: 3,  Best: 6.6008e-02,  Worst: 1.2886e+00
x(1) = 7.991711e+00
x(2) = 8.495992e-01
Iteration: 4,  Best: 6.6008e-02,  Worst: 8.6775e-01
x(1) = 7.991711e+00
x(2) = 8.495992e-01
Iteration: 5,  Best: 6.4967e-02,  Worst: 6.0711e-01
x(1) = 7.757662e+00
x(2) = 1.000000e+00
Iteration: 6,  Best: 6.4796e-02,  Worst: 3.1152e-01
x(1) = 7.594315e+00
x(2) = 9.720275e-01
Iteration: 7,  Best: 6.4772e-02,  Worst: 7.9872e-02
x(1) = 7.536331e+00
x(2) = 1.000000e+00
Iteration: 8,  Best: 6.4772e-02,  Worst: 7.9872e-02
x(1) = 7.536331e+00
x(2) = 1.000000e+00
Iteration: 9,  Best: 6.4765e-02,  Worst: 7.3475e-02
x(1) = 7.551525e+00
x(2) = 1.000000e+00
Iteration: 10,  Best: 6.4762e-02,  Worst: 6.8626e-02
x(1) = 7.589799e+00
x(2) = 1.000000e+00
Iteration: 11,  Best: 6.4761e-02,  Worst: 6.8626e-02
x(1) = 7.574008e+00
x(2) = 9.999530e-01
Iteration: 12,  Best: 6.4761e-02,  Worst: 6.6624e-02
x(1) = 7.574008e+00
x(2) = 9.999530e-01
Iteration: 13,  Best: 6.4761e-02,  Worst: 6.4974e-02
x(1) = 7.574008e+00
x(2) = 9.999530e-01
Elapsed time is 532.279 seconds.


Optimiation process done.

                                                                                                  Hysteretic curve after optimisation of k and c
  B (T)
    0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
        +                                     +                                    +                                     +                                     +                                    +                                     +
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                           --+-+--+-+--+-+                                |
        |                                     :                                    :                                     :                                     :               -+--+-+--+-+--+-+--+-+-                                    |
        |                                     :                                    :                                     :                                     :     -+-+--+--+-+--+-+--+-+-        :                                     |
    0.3 ++...................................................................................................................................................-+--+--+-+...-+--+-+--+.....................................................++
        |                                     :                                    :                                     :                           --+-+--+-+:     -+--+-+-                       :                                     |
        |                                     :                                    :                                     :                       -+-+   -+     :   -+-+-                            :                                     |
        |                                     :                                    :                                     :                    --+  -+--+      -+-+--+                               :                                     |
        |                                     :                                    :                                     :               -+--+   -+        -+--+                                    :                                     |
        |                                     :                                    :                                     :            --+     --+       -+--+- :                                    :                                     |
        |                                     :                                    :                                     :          -+     --+        -+-+-    :                                    :                                     |
    0.2 ++.......................................................................................................................--+.....-+.........++-+.................................................................................++
        |                                     :                                    :                                     :      +     --+      +++++-+         :                                    :                                     |
        |                                     :                                    :                                     :     +    -+     ++++++++-           :                                    :                                     |
        |                                     :                                    :                                     :  --+  --+   +++++ +++-              :                                    :                                     |
        |                                     :                                    :                                     : +        +++    ++++                :                                    :                                     |
        |                                     :                                    :                                     :+    -++++      ++-                  :                                    :                                     |
        |                                     :                                    :                                   --+  --++++      ++++                   :                                    :                                     |
    0.1 ++...................................................................................................................+++......++++...............................................................................................++
        |                                     :                                    :                                  +  :-+++     ++++++                      :                                    :                                     |
        |                                     :                                    :                                 + --+++    ++++++--                       :                                    :                                     |
        |                                     :                                    :                              --+   ++    ++++++++                         :                                    :                                     |
        |                                     :                                    :                                  +++: ++++++++++                          :                                    :                                     |
        |                                     :                                    :                             +   ++  +++ +++++ +                           :                                    :                                     |
      0 ++.......................................................................................................|--++++++.++++++.+......................................................................................................++
        |                                     :                                    :                             |++++++ +++ ++  +                             :                                    :                                     |
        |                                     :                                    :                         --+-+++++ +++  +-  +                              :                                    :                                     |
        |                                     :                                    :                         --++++++++  : +   +                               :                                    :                                     |
        |                                     :                                    :                        + +++++++    ++   +                                :                                    :                                     |
        |                                     :                                    :                       +++++++     +++  --                                 :                                    :                                     |
        |                                     :                                    :                    --+++++      ++- : +                                   :                                    :                                     |
   -0.1 ++..............................................................................................-++++......+++....+..............................................................................................................++
        |                                     :                                    :                   ++++      ++++    +                                     :                                    :                                     |
        |                                     :                                    :                  +++      +++--   --:                                     :                                    :                                     |
        |                                     :                                    :               --++     +++ -+   -+  :                                     :                                    :                                     |
        |                                     :                                    :             -++++ +++++  -+    +    :                                     :                                    :                                     |
        |                                     :                                    :          --++++++++   -+-    --     :                                     :                                    :                                     |
        |                                     :                                    :         +++++++      +     -+       :                                     :                                    :                                     |
   -0.2 ++..................................................................................-++.........--....-+.........................................................................................................................++
        |                                     :                                    :   -+--+        -+-+   -+-           :                                     :                                    :                                     |
        |                                     :                                    :--+-+        -+-     -+              :                                     :                                    :                                     |
        |                                     :                                   -+--+        -+   -+-+-                :                                     :                                    :                                     |
        |                                     :                                --+-+        -+-  -+-                     :                                     :                                    :                                     |
        |                                     :                           --+-+    :   -+--+-+--+                        :                                     :                                    :                                     |
        |                                     :                      --+-+--+     -+--+-+--+                             :                                     :                                    :                                     |
   -0.3 ++....................................................-+--+-+--+...-+-+--+-+--+..................................................................................................................................................++
        |                                     :       --+-+--+-+   -+--+-+--+-+-   :                                     :                                     :                                    :                                     |
        |                                   --+-+--+-+--+-+--+-+--+-+-             :                                     :                                     :                                    :                                     |
        |                                +-+--+-+--+-+-                            :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        +                                     +                                    +                                     +                                     +                                    +                                     +
   -0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
      -150                                  -100                                  -50                                    0                                    50                                   100                                   150
                                                                                                                      H (A/m)

Adding the hysteresis: Cheng model... 

Initial point... 
                                                                                                             Hysteretic curve initial
  B (T)
    0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
        +                                     +                                    +                                     +                                     +                                    +                                     +
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                           --+-+--+-+--+-+                                |
        |                                     :                                    :                                     :                                     :               -+--+-+--+-+--+-+--+-+--+-+                                |
        |                                     :                                    :                                     :                                     :     -+-+--+--+-+--+-+-  -+--+-+-   :                                     |
    0.3 ++...................................................................................................................................................-+--+--+-+...-+--+...-+-+--+................................................++
        |                                     :                                    :                                     :                           --+-+--+-+:     -+--+   -+-+-                  :                                     |
        |                                     :                                    :                                     :                       -+-+--+-+     :   -+   -+-+-                       :                                     |
        |                                     :                                    :                                     :                    --+-+-+         -+-+-  -+-                            :                                     |
        |                                     :                                    :                                     :               -+--+--+          -+- :   -+                               :                                     |
        |                                     :                                    :                                     :            --+  --+          -+-   -+-+-                                 :                                     |
        |                                     :                                    :                                     :          -+   -+           -+   -+- :                                    :                                     |
    0.2 ++.......................................................................................................................--+..--+...........++..-+-..............................................................................++
        |                                     :                                    :                                     :      +   -+         +++++- -+       :                                    :                                     |
        |                                     :                                    :                                     :     + --+       ++++ ++++++         :                                    :                                     |
        |                                     :                                    :                                     :  --+ +      ++++ ++++-+++-          :                                    :                                     |
        |                                     :                                    :                                     : +   +    ++++++++++  +++            :                                    :                                     |
        |                                     :                                    :                                     :+ --+  ++++++   ++- ++-              :                                    :                                     |
        |                                     :                                    :                                   --+ +   ++++     +++ ++                 :                                    :                                     |
    0.1 ++................................................................................................................+..++++.....++.+.+-............................................................................................++
        |                                     :                                    :                                  +--+ +++     ++++ +++                    :                                    :                                     |
        |                                     :                                    :                                 ++  :++    +++++ --+                      :                                    :                                     |
        |                                     :                                    :                              --++ +++    +++++++++-                       :                                    :                                     |
        |                                     :                                    :                              --+ ++ : ++++++++ ++                         :                                    :                                     |
        |                                     :                                    :                             +  +++  ++++++++++++                          :                                    :                                     |
      0 ++......................................................................................................-|++++++++.+++++.+++.....................................................................................................++
        |                                     :                                    :                         --+ | +++++ +++ +++++                             :                                    :                                     |
        |                                     :                                    :                         --+++++++++++  +++++                              :                                    :                                     |
        |                                     :                                    :                        +++ +++++++  : ++ ++                               :                                    :                                     |
        |                                     :                                    :                       ++ +++++++    +++--+                                :                                    :                                     |
        |                                     :                                    :                    --++  ++++     ++:-+--                                 :                                    :                                     |
        |                                     :                                    :                   +--+ +++      ++  + +                                   :                                    :                                     |
   -0.1 ++............................................................................................++...++.....++++.--.+..............................................................................................................++
        |                                     :                                    :               --+++ ++    +++++ -+  +                                     :                                    :                                     |
        |                                     :                                    :              +++ +++  +++++++  +  --:                                     :                                    :                                     |
        |                                     :                                    :             ++--++++++ +++   -- -+  :                                     :                                    :                                     |
        |                                     :                                    :          -++-++++  ++++    -+  +    :                                     :                                    :                                     |
        |                                     :                                    :        -+--+++ ++++      -+  --     :                                     :                                    :                                     |
        |                                     :                                    :     --+   +++++       -+-  -+       :                                     :                                    :                                     |
   -0.2 ++.............................................................................-+...-++..........-+...-+.........................................................................................................................++
        |                                     :                                    :--+  --+          -+-  -+-           :                                     :                                    :                                     |
        |                                     :                                   -+   -+           -+   -+              :                                     :                                    :                                     |
        |                                     :                              -+--+ :--+          -+--+-+-                :                                     :                                    :                                     |
        |                                     :                           --+  --+-+        -+--+-+-                     :                                     :                                    :                                     |
        |                                     :                      --+-+   -+    :      -+-+--+                        :                                     :                                    :                                     |
        |                                     :                 --+-+   -+--+     -+--+-+--+                             :                                     :                                    :                                     |
   -0.3 ++...............................................-+--+-+--+-+--+.....-+--+-+--+..................................................................................................................................................++
        |                                     :  --+-+--+  --+-+ -+-+--+-+--+-+-   :                                     :                                     :                                    :                                     |
        |                                +-+--+-+--+-+--+-+--+-+--+-+-             :                                     :                                     :                                    :                                     |
        |                                +-+--+-+--+-+-                            :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        +                                     +                                    +                                     +                                     +                                    +                                     +
   -0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
      -150                                  -100                                  -50                                    0                                    50                                   100                                   150
                                                                                                                      H (A/m)

Optimization process started... 

Iteration: 1,  Best: 7.1834e-02,  Worst: 9.8159e-01
x(1) = 1.955072e+01
x(2) = 5.734819e-01
Iteration: 2,  Best: 6.8227e-02,  Worst: 2.1351e-01
x(1) = 2.070566e+01
x(2) = 4.403644e-01
Iteration: 3,  Best: 6.8227e-02,  Worst: 1.3097e-01
x(1) = 2.070566e+01
x(2) = 4.403644e-01
Iteration: 4,  Best: 6.6727e-02,  Worst: 1.0592e-01
x(1) = 2.121069e+01
x(2) = 5.353252e-01
Iteration: 5,  Best: 6.6047e-02,  Worst: 9.1795e-02
x(1) = 2.054118e+01
x(2) = 5.157099e-01
Iteration: 6,  Best: 6.6021e-02,  Worst: 8.3503e-02
x(1) = 2.034562e+01
x(2) = 5.124163e-01
Iteration: 7,  Best: 6.5924e-02,  Worst: 7.2761e-02
x(1) = 2.062073e+01
x(2) = 5.086923e-01
Iteration: 8,  Best: 6.5843e-02,  Worst: 6.9319e-02
x(1) = 2.047209e+01
x(2) = 5.014553e-01
Iteration: 9,  Best: 6.5825e-02,  Worst: 6.7894e-02
x(1) = 2.041095e+01
x(2) = 4.983089e-01
Iteration: 10,  Best: 6.5825e-02,  Worst: 6.7283e-02
x(1) = 2.041095e+01
x(2) = 4.983089e-01
Iteration: 11,  Best: 6.5825e-02,  Worst: 6.6310e-02
x(1) = 2.041095e+01
x(2) = 4.983089e-01
Elapsed time is 453.938 seconds.


Optimiation process done.

                                                                                                  Hysteretic curve after optimisation of k and c
  B (T)
    0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
        +                                     +                                    +                                     +                                     +                                    +                                     +
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                           --+-+--+-+--+-+                                |
        |                                     :                                    :                                     :                                     :               -+--+-+--+-+--+-+--+-+-                                    |
        |                                     :                                    :                                     :                                     :     -+-+--+--+-+--+-+--+-+-        :                                     |
    0.3 ++...................................................................................................................................................-+--+--+-+...-+--+-+--+.....................................................++
        |                                     :                                    :                                     :                           --+-+--+-+:     -+--+-+-                       :                                     |
        |                                     :                                    :                                     :                       -+-+   -+     :   -+-+-                            :                                     |
        |                                     :                                    :                                     :                    --+  -+--+      -+-+-                                 :                                     |
        |                                     :                                    :                                     :               -+--+   -+        -+--+                                    :                                     |
        |                                     :                                    :                                     :            --+     --+       -+--+- :                                    :                                     |
        |                                     :                                    :                                     :          -+     --+        -+-+-    :                                    :                                     |
    0.2 ++.......................................................................................................................--+.....-+.........++-+.................................................................................++
        |                                     :                                    :                                     :      +     --+      +++++-+         :                                    :                                     |
        |                                     :                                    :                                     :     +    -+     ++++++++-           :                                    :                                     |
        |                                     :                                    :                                     :  --+  --+   +++++ +++-              :                                    :                                     |
        |                                     :                                    :                                     : +        +++    ++++                :                                    :                                     |
        |                                     :                                    :                                     :+    -++++      ++-+                 :                                    :                                     |
        |                                     :                                    :                                   --+  --++++      ++++                   :                                    :                                     |
    0.1 ++...................................................................................................................+++......++++...............................................................................................++
        |                                     :                                    :                                  +  :-+++     ++++++                      :                                    :                                     |
        |                                     :                                    :                                 + --+++    ++++++--                       :                                    :                                     |
        |                                     :                                    :                              --+   +++   ++++++++                         :                                    :                                     |
        |                                     :                                    :                                  +++: ++++++++++                          :                                    :                                     |
        |                                     :                                    :                             +   ++  +++ +++++-+                           :                                    :                                     |
      0 ++.......................................................................................................|--++++++.+++.++.+......................................................................................................++
        |                                     :                                    :                             |++ +++ +++ ++  +                             :                                    :                                     |
        |                                     :                                    :                         --+-+++++ +++  +-  +                              :                                    :                                     |
        |                                     :                                    :                         --+++++++++ :++   +                               :                                    :                                     |
        |                                     :                                    :                        + +++++++   +++   +                                :                                    :                                     |
        |                                     :                                    :                       +++++++     +++  --                                 :                                    :                                     |
        |                                     :                                    :                    --+++++      ++- : +                                   :                                    :                                     |
   -0.1 ++..............................................................................................-++++......+++....+..............................................................................................................++
        |                                     :                                    :                   ++++      ++++    +                                     :                                    :                                     |
        |                                     :                                    :                  +++      +++--   --:                                     :                                    :                                     |
        |                                     :                                    :               --++     +++ -+   -+  :                                     :                                    :                                     |
        |                                     :                                    :             -++++ +++++  -+    +    :                                     :                                    :                                     |
        |                                     :                                    :          --++++++++   -+-    --     :                                     :                                    :                                     |
        |                                     :                                    :        -+++++++     -+     -+       :                                     :                                    :                                     |
   -0.2 ++...............................................................................--+-++.......-+-.....-+.........................................................................................................................++
        |                                     :                                    :   -+--+        -+     -+-           :                                     :                                    :                                     |
        |                                     :                                    :--+-+        -+-     -+              :                                     :                                    :                                     |
        |                                     :                                   -+--+        -+   -+-+-                :                                     :                                    :                                     |
        |                                     :                                --+-+      -+-+-  -+-                     :                                     :                                    :                                     |
        |                                     :                           --+-+    :   -+-  -+--+                        :                                     :                                    :                                     |
        |                                     :                      --+-+--+     -+--+-+--+                             :                                     :                                    :                                     |
   -0.3 ++....................................................-+--+-+--+...-+-+--+-+--+..................................................................................................................................................++
        |                                     :       --+-+--+-+   -+--+-+--+-+-   :                                     :                                     :                                    :                                     |
        |                                   --+-+--+-+--+-+--+-+--+-+-             :                                     :                                     :                                    :                                     |
        |                                +-+--+-+--+-+-                            :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        |                                     :                                    :                                     :                                     :                                    :                                     |
        +                                     +                                    +                                     +                                     +                                    +                                     +
   -0.4 ++------------------------------------+------------------------------------+-------------------------------------+-------------------------------------+------------------------------------+------------------------------------++
      -150                                  -100                                  -50                                    0                                    50                                   100                                   150
                                                                                                                      H (A/m)



Demonstration of identification of Jiles-Atherton models parameters for three hysteresis loops.
Multistep solver.
Demonstration optimized for OCTAVE.  
Demonstration requires odepkg, struct and optim packages installed.


 odepkg installed...ok.
 odepkg loaded...ok.


 struct installed...ok.
 struct loaded...ok.


 optim installed...ok.
 optim loaded...ok.

Load measured B(H) characterisitcs of Mn-Zn ferrite... done

Initial analyse of input data... 

Number of loops: 3 
Maximal magnetizing field H(A/m): 106.29, pos. at col:1 , pos. at row:3 
Maximal magnetization M(A/m): 274427 
Maximal flux density B(T): 0.345 
Number of x axis crossings at major loop: 2 
Estimated value of Hc (A/m): 11.68 

Done. 

Identification of parameters for anhysteretic loop...

Initial target value for a=11.684 (A/m), Ms=274427 (A/m), alpha=1.000000e-006 Target=0.366 

Optimization process started... 


>> 
>> 
>> 
>> 
>> 
>> clear all
>> DemoPeng_et_al_view


Demonstration of identification of Jiles-Atherton models parameters for three hysteresis loops.
Multistep solver.
Demonstration optimized for OCTAVE.  
Demonstration requires odepkg, struct and optim packages installed.


 odepkg installed...ok.
 odepkg loaded...ok.


 struct installed...ok.
 struct loaded...ok.


 optim installed...ok.
 optim loaded...ok.

Load measured B(H) characterisitcs of Mn-Zn ferrite... done

Initial analyse of input data... 

Number of loops: 3 
Maximal magnetizing field H(A/m): 106.29, pos. at col:1 , pos. at row:3 
Maximal magnetization M(A/m): 274427 
Maximal flux density B(T): 0.345 
Number of x axis crossings at major loop: 2 
Estimated value of Hc (A/m): 11.68 

Done. 

Identification of parameters for anhysteretic loop...

Initial target value for a=11.684 (A/m), Ms=274427 (A/m)
 alpha=1.000000e-006 Target=0.366 

Optimization process started... done.

Final target values for anhysteretic curve: a=20.313 (A/m), Ms=333107 (A/m)
 alpha=3.215240e-005 Target=0.307 

Adding the hysteresis: JA model... 
k=7.574, c=0.99995 

Adding the hysteresis: Cheng et al. model... 
k=20.411, c=0.49831 

>> exit

